{{- $curPage := . -}}
{{- $images := (slice) -}}
{{- $image := (dict) -}}
{{- with .Params.images -}}
    {{- range first 6 . -}}
        {{- if not (reflect.IsSlice .) -}}{{- /* We must either get a map (dict) or a slice (array) */ -}}
            {{- with (partial "helpers/lib/image-handling/find-image-src" (dict "src" .src "alt" .alt "page" $curPage "getRelative" false "ignoreBundleAssets" false)) -}}            
                {{- $images = $images | append . -}}
            {{- end -}}
        {{- else -}}            
            {{- with (partial "helpers/lib/image-handling/find-image-src" (dict "src" (index . 0) "alt" (index . 1) "page" $curPage "getRelative" false "ignoreBundleAssets" false)) -}}            
                {{- $images = $images | append . -}}
            {{- end -}}
        {{- end -}}
    {{- end -}}
{{- end -}}
{{- if eq (len $images) 0 -}}
    {{- with $curPage.Site.Params.images -}}
        {{- if not (reflect.IsSlice (index . 0)) -}}{{- /* We must either get a slice of map (dict) or a slice of slice (array) */ -}}
            {{- $image = partial "helpers/lib/image-handling/find-image-src" (dict "src" (index . 0).src "alt" (index . 0).alt "page" $curPage "getRelative" false "ignoreBundleAssets" true) -}}
        {{- else -}}
            {{- $image = partial "helpers/lib/image-handling/find-image-src" (dict "src" (index (index . 0) 0) "alt" (index (index . 0) 1) "page" $curPage "getRelative" false "ignoreBundleAssets" true) -}}
        {{- end -}}
    {{- end -}}        
    {{- if not $image.link -}}
        {{- $image = partial "helpers/lib/image-handling/find-featured-image" (dict "page" $curPage "getRelative" false "ignoreBundleAssets" false) -}}
    {{- end -}}
    {{- with $image -}}
        {{- $images = $images | append . -}}
    {{- end -}}
{{- end -}}
{{- return $images -}}