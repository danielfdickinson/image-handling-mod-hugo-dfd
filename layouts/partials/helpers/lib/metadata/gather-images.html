{{- $curPage := . -}}
{{- $images := (slice) -}}
{{- $image := (dict) -}}
{{- with .Params.images -}}
    {{- range first 6 . -}}
        {{- with (partial "helpers/lib/image-handling/find-image-src" (dict "src" . "page" $curPage "getRelative" false "ignoreBundleAssets" false)) -}}
            {{- $images = $images | append . -}}
        {{- end -}}
    {{- end -}}
{{- end -}}
{{- if eq (len $images) 0 -}}
    {{- with $curPage.Site.Params.images -}}
        {{- $image = partial "helpers/lib/image-handling/find-image-src" (dict "src" (index . 0) "page" $curPage "getRelative" false "ignoreBundleAssets" true) -}}
    {{- end -}}
    {{- if not $image.link -}}
        {{- $image = partial "helpers/lib/image-handling/find-featured-image" (dict "page" $curPage "getRelative" false "ignoreBundleAssets" false) -}}
    {{- end -}}
    {{- with $image -}}
        {{- $images = $images | append . -}}
    {{- end -}}
{{- end -}}
{{- return $images -}}